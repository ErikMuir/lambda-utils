{"version":3,"sources":["../../src/utilities/LambdaLogger.js"],"names":["LambdaLogger","constructor","name","logType","data","LogLevel","LogEnv","logLevel","message","error","categorizedData","_categorize","lambdaContext","lambdaEvent","console","JSON","stringify","time","Date","toISOString","level","logger","trim","userId","executionName","awsRequestId","functionName","remainingTime","getRemainingTimeInMillis","exception","stack","k","v","undefined","forEach","d","Error","push","length","trace","_log","debug","info","warn"],"mappings":"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","sourcesContent":["import LogLevel from './LogLevel';\nimport LogEnv from './LogEnv';\n\nexport default class LambdaLogger {\n  constructor(name) {\n    this.name = name;\n  }\n\n  trace(...data) { this._log('trace', data); }\n  debug(...data) { this._log('debug', data); }\n  info(...data) { this._log('info', data); }\n  warn(...data) { this._log('warn', data); }\n  error(...data) { this._log('error', data); }\n\n  _log = (logType, data) => {\n    if (LogLevel[logType] < LogLevel[LogEnv.logLevel]) {\n      return;\n    }\n    \n    const { message, error, categorizedData } = this._categorize(data);\n    const { lambdaContext, lambdaEvent } = LogEnv;\n\n    console[logType](\n      JSON.stringify(\n        {\n          time: new Date().toISOString(),\n          level: logType,\n          logger: this.name,\n          message: message.trim(),\n          userId: lambdaEvent && lambdaEvent.userId,\n          executionName: lambdaEvent && lambdaEvent.executionName,\n          awsRequestId: lambdaContext && lambdaContext.awsRequestId,\n          functionName: lambdaContext && lambdaContext.functionName,\n          remainingTime:\n            lambdaContext && lambdaContext.getRemainingTimeInMillis && lambdaContext.getRemainingTimeInMillis(),\n          exception: error && error.stack,\n          data: categorizedData,\n        },\n        (k, v) => (!v ? undefined : v)\n      )\n    );\n  };\n\n  _categorize = data => {\n    let message = '',\n      error,\n      categorizedData = [];\n\n    data.forEach(d => {\n      switch (typeof d) {\n        case 'number':\n        case 'string':\n        case 'boolean':\n          message += `${d} `;\n          break;\n        default:\n          if (d instanceof Error) {\n            error = d;\n          } else {\n            categorizedData.push(d);\n          }\n      }\n    });\n\n    if (categorizedData.length === 0) {\n      categorizedData = undefined;\n    } else if (categorizedData.length === 1) {\n      categorizedData = categorizedData[0];\n    }\n\n    return { message, error, categorizedData };\n  };\n}\n"],"file":"LambdaLogger.js"}